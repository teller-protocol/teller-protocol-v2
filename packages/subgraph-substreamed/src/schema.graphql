type factory_admin_changed @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
   
    evt_block_number: BigInt!
    new_admin: String!
    previous_admin: String!
}
type factory_beacon_upgraded @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
     
    evt_block_number: BigInt!
    beacon: String!
}
type factory_deployed_lender_group_contract @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
  
    evt_block_number: BigInt!
    group_contract: String!
}
type factory_upgraded @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
  
    evt_block_number: BigInt!
    implementation: String!
}

type group_borrower_accepted_funds @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
    
    evt_block_number: BigInt!
    group_pool_address: String!
    bid_id: BigDecimal!
    borrower: String!
    collateral_amount: BigDecimal!
    interest_rate: Int!
    loan_duration: Int!
    principal_amount: BigDecimal!
}

type group_lender_added_principal @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
    
    evt_block_number: BigInt!
    group_pool_address: String!
    amount: BigDecimal!
    lender: String!
    shares_amount: BigDecimal!
    shares_recipient: String!
}
type group_earnings_withdrawn @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
   
    evt_block_number: BigInt!
    group_pool_address: String!
    amount_pool_shares_tokens: BigDecimal!
    lender: String!
    principal_tokens_withdrawn: BigDecimal!
    recipient: String!
}
type group_defaulted_loan_liquidated @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
    
    evt_block_number: BigInt!
    group_pool_address: String!
    amount_due: BigDecimal!
    bid_id: BigDecimal!
    liquidator: String!
    token_amount_difference: BigDecimal!
}
type group_initialized @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
     
    evt_block_number: BigInt!
    group_pool_address: String!
    version: Int!
}

type group_loan_repaid @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
     
    evt_block_number: BigInt!
    group_pool_address: String!
    bid_id: BigDecimal!
    interest_amount: BigDecimal!
    principal_amount: BigDecimal!
    repayer: String!
    total_interest_collected: BigDecimal!
    total_principal_repaid: BigDecimal!
}
type group_ownership_transferred @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
    
    evt_block_number: BigInt!
    group_pool_address: String!
    new_owner: String!
    previous_owner: String!
}
type group_paused @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
    
    evt_block_number: BigInt!
    group_pool_address: String!
    account: String!
}
type group_pool_initialized @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
    
    evt_block_number: BigInt!
    group_pool_address: String!
    collateral_token_address: String!
    interest_rate_lower_bound: Int!
    interest_rate_upper_bound: Int!
    liquidity_threshold_percent: Int!
    loan_to_value_percent: Int!
    market_id: BigDecimal!
    max_loan_duration: Int!
    pool_shares_token: String!
    principal_token_address: String!
    twap_interval: Int!
    uniswap_pool_fee: Int!
}
type group_unpaused @entity {
    id: ID!
    evt_tx_hash: String!
    evt_index: BigInt!
    
    evt_block_number: BigInt!
    group_pool_address: String!
    account: String!
}



type group_pool_metrics @entity {
    id: ID!    #will be based on group pool address 
    group_pool_address: String!

    principal_token_address: String!
    collateral_token_address: String!
    shares_token_address: String!

    uniswap_v3_pool_address: String!
    teller_v2_address: String!
    smart_commitment_forwarder_address: String! 
 
    market_id: Int!

    max_loan_duration : Int!
    twap_interval : Int!
    interest_rate_upper_bound: Int!
    interest_rate_lower_bount: Int!

    liquidity_threshold_percent: Int!
    collateral_ratio: Int!
   
    total_principal_tokens_committed: Int!
    total_principal_tokens_withdrawn: Int!
    
    total_principal_tokens_lended: Int!
    total_principal_tokens_repaid: Int!
    total_interest_collected: Int!

    token_difference_from_liquidations: Int!

  
}


type group_lender_metrics @entity {
    id: ID!   #will be based on group pool address and user lender address 
    
    user_lender_address: String!
    group_pool_address: String!

    total_principal_tokens_committed: Int!
    total_principal_tokens_withdrawn: Int!

    shares_tokens_net: Int! 

    
}